{#
  @file
  Default theme implementation

  @see 'template_preprocess_pps_energy_tracker_css()'
#}

{{ attach_library('pps_energy_tracker/pps_energy_tracker_css') }}

<div>
    <div>
        <p>Hello World: Energy Tracker</p>
        <a href="/energy_tracker/generic_graphs">Generic</a> </br>
        <a href="/energy_tracker/natural_gas_graphs">Natural Gas Graphs</a> </br>
        <a href="/energy_tracker/account_management">Account Management</a> </br>
        <a href="/">PPS Home Page</a> </br>
    </div>
    <div class="graph-top-content">
        <div class="graph-form">
            {{ element_content }}
        </div>
        <div class="account-table">
            {{ table_content }}
        </div>
    </div>
    <div class="graph-bottom-content">
        {% if graph_data %}
            {{ attach_library('pps_energy_tracker/pps_energy_tracker_graph') }}
            <script>
                var dataPoints = [];
                var passedFromController = {{ graph_data|json_encode|raw }};
                //EX: passedFromController Format -> "2013-03-01"[0.0478175]
                var parsed = JSON.parse(passedFromController);
                window.onload = function () {
                    for(var key in parsed)
                        dataPoints.push({x: new Date(key), y: parsed[key][0]});

                    var chart = new CanvasJS.Chart("chartContainer",
                            {
                                title:{
                                    text: "ACCOUNT NUMBER/NAME" + " Pricing"
                                },
                                axisX: {
                                    valueFormatString: "MMM",
                                    interval:1,
                                    intervalType: "month"
                                },
                                axisY:{
                                    includeZero: false
                                },
                                data: [
                                    {
                                        type: "line",
                                        dataPoints: dataPoints
                                    }
                                ]
                            });
                    chart.render();
                }
            </script>
            <div id="chartContainer"></div>
        {% endif %}
    </div>
</div>